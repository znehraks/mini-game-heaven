# Context Management Configuration
# claude-symphony context management settings

context_management:
  # Percentage-based thresholds (based on remaining context)
  thresholds:
    warning: 60       # Display warning at 60% remaining
    action: 50        # Auto-save + recommend compression at 50% remaining
    critical: 40      # Force recommend /clear at 40% remaining

  # Task-based save frequency
  task_save_frequency: 5  # Auto-save state every 5 tasks

  # Estimated max tokens (Claude basis)
  max_tokens: 200000

# Auto action settings
auto_actions:
  on_warning:
    - display_warning_banner
    - calculate_compression_ratio

  on_action_threshold:
    - save_state_to_file
    - generate_context_summary
    - suggest_compression

  on_critical:
    - force_state_save
    - generate_recovery_handoff
    - prompt_clear_confirmation  # Execute /clear after user confirmation

# State saving settings
state_saving:
  directory: "state/context"
  filename_format: "state_{timestamp}_{stage}.md"

  # Save triggers
  triggers:
    - threshold_crossed
    - task_batch_complete
    - manual_checkpoint
    - stage_transition

  # Items to save
  include:
    - current_stage
    - progress_summary
    - active_tasks
    - key_decisions
    - recovery_instructions
    - file_modifications

# Context compression settings
compression:
  auto_activate_at: 50  # Auto-activate at action threshold

  strategies:
    - name: "summarize_completed"
      description: "Replace completed work with summaries"
      priority: 1

    - name: "externalize_code"
      description: "Replace code blocks with file references"
      priority: 2

    - name: "handoff_generation"
      description: "Externalize current state to HANDOFF.md"
      priority: 3

# Monitoring settings
monitoring:
  display_in_prompt: true
  update_interval: "per_response"

  # Status display format
  display_format: |
    [Context: {remaining_percent}% | {remaining_tokens}k tokens]
